language: python
docker: true
versions:
  - '3.8'
  - '3.9'
  - '3.10'
  - '3.11'

branches:
  - master

steps:
  - name: setup db
    command: ./build-scripts/db.sh

  - name: Run tests
    command: pytest setup.py test
    timeout: 120


builders:
  - name: release
    branches:
      - release

    plugins:
      - name: python-venv
        pyversion: python3.11

    platform: python3.11

    steps:
      - name: Upload documentation
        command: pdj-deployer pdj01 software_deploy mongomotor release
